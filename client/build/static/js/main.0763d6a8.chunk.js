(this["webpackJsonpquiz-app"]=this["webpackJsonpquiz-app"]||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(32),s=n.n(r),o=(n(93),n(4)),i=n(35),l=n(8),j=n(84),u=n(118),b=n(119),d=n(115),O=n.p+"static/media/mern-logo.0e1fd87c.png",h=n(2);var m=function(){return Object(h.jsx)("header",{className:"d-flex",children:Object(h.jsxs)("div",{className:"d-flex row",children:[Object(h.jsx)("div",{className:"logo-div mx-3 m-1",children:Object(h.jsx)("img",{className:"mern-logo",src:O,alt:"MERN Logo"})}),Object(h.jsx)("div",{className:"mern-trivia",children:Object(h.jsx)("h1",{className:"m-0",children:"MERN Trivia"})})]})})};var x=function(){return Object(h.jsx)("footer",{className:"page-footer"})},p=n(7),f=n(18),v=n(19),g=n(64),w=new(function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,[{key:"getProfile",value:function(){return Object(g.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return Object(g.a)(e).exp<Date.now()/1e3}catch(t){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}());var N,S,k=function(){console.log(w.loggedIn());var e=Object(c.useState)(""),t=Object(p.a)(e,2),n=t[0],a=(t[1],Object(l.m)());return Object(h.jsxs)("main",{className:"page-main d-flex justify-content-center align-items-center",children:[Object(h.jsxs)("div",{className:"text-center",children:["Welcome, ",n,"!"]}),Object(h.jsxs)("div",{className:"home-buttons m-5",children:[Object(h.jsx)("button",{className:"btn",onClick:function(){a("/select")},children:"Quizzes"}),Object(h.jsx)("button",{className:"btn",onClick:function(){a("/profile")},children:"Profile"}),w.loggedIn()?Object(h.jsx)("button",{className:"btn",onClick:w.logout,children:"Logout"}):Object(h.jsx)("button",{className:"btn",onClick:function(){a("/login")},children:"Login"})]})]})},y=n(10),C=n(17),_=n(13),E=n(117),q=n(116),T=n(113),I=n(120),G=n(65),L=n(69),A=Object(L.a)(N||(N=Object(G.a)(["\nmutation loginUser($username: String!, $password: String!) {\n  login(username: $username, password: $password) {\n    token\n    user {\n      _id\n    }\n  }\n}\n"]))),F=Object(L.a)(S||(S=Object(G.a)(["\nmutation addUser($username: String!, $password: String!) {\n  addUser(username: $username, password: $password) { \n    user {\n      _id\n      username\n    }\n    token\n  }\n}\n"]))),D=function(){var e=Object(c.useState)({username:"",password:""}),t=Object(p.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),s=Object(p.a)(r,1)[0],i=Object(c.useState)(!1),l=Object(p.a)(i,2),j=l[0],u=l[1],b=Object(I.a)(A),d=Object(p.a)(b,2),O=d[0],m=(d[1].error,function(e){var t=e.target,c=t.name,r=t.value;a(Object(o.a)(Object(o.a)({},n),{},Object(_.a)({},c,r)))}),x=function(){var e=Object(C.a)(Object(y.a)().mark((function e(t){var c,r;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),!1===t.currentTarget.checkValidity()&&(t.preventDefault(),t.stopPropagation()),e.prev=3,e.next=6,O({variables:Object(o.a)({},n)});case 6:c=e.sent,r=c.data,w.login(r.login.token),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.error(e.t0),u(!0);case 15:a({username:"",password:""});case 16:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{children:"Login"}),Object(h.jsxs)(E.a,{noValidate:!0,validated:s,onSubmit:x,children:[Object(h.jsx)(q.a,{dismissible:!0,onClose:function(){return u(!1)},show:j,variant:"danger",children:"Something went wrong with your login credentials!"}),Object(h.jsxs)(E.a.Group,{children:[Object(h.jsx)(E.a.Label,{htmlFor:"username",children:"Username"}),Object(h.jsx)(E.a.Control,{type:"text",placeholder:"Your username",name:"username",onChange:m,value:n.username,required:!0}),Object(h.jsx)(E.a.Control.Feedback,{type:"invalid",children:"Username is required!"})]}),Object(h.jsxs)(E.a.Group,{children:[Object(h.jsx)(E.a.Label,{htmlFor:"password",children:"Password"}),Object(h.jsx)(E.a.Control,{type:"password",placeholder:"Your password",name:"password",onChange:m,value:n.password,required:!0}),Object(h.jsx)(E.a.Control.Feedback,{type:"invalid",children:"Password is required!"})]}),Object(h.jsx)(T.a,{disabled:!(n.username&&n.password),type:"submit",variant:"success",children:"Submit"})]})]})},H=function(){var e=Object(c.useState)({username:"",password:""}),t=Object(p.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),s=Object(p.a)(r,1)[0],i=Object(c.useState)(!1),l=Object(p.a)(i,2),j=l[0],u=l[1],b=Object(I.a)(F),d=Object(p.a)(b,1)[0],O=function(e){var t=e.target,c=t.name,r=t.value;a(Object(o.a)(Object(o.a)({},n),{},Object(_.a)({},c,r)))},m=function(){var e=Object(C.a)(Object(y.a)().mark((function e(t){var c,r;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(n),!1===t.currentTarget.checkValidity()&&(t.preventDefault(),t.stopPropagation()),console.log("after propogation"),e.prev=5,e.next=8,d({variables:Object(o.a)({},n)});case 8:c=e.sent,r=c.data,console.log("data",r),w.login(r.addUser.token),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(5),console.error(e.t0),u(!0);case 18:console.log("after Auth login"),a({username:"",password:""});case 20:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{children:"Signup"}),Object(h.jsxs)(E.a,{noValidate:!0,validated:s,onSubmit:m,children:[Object(h.jsx)(q.a,{dismissible:!0,onClose:function(){return u(!1)},show:j,variant:"danger",children:"Something went wrong with your signup!"}),Object(h.jsxs)(E.a.Group,{children:[Object(h.jsx)(E.a.Label,{htmlFor:"username",children:"Username"}),Object(h.jsx)(E.a.Control,{type:"text",placeholder:"Create username",name:"username",onChange:O,value:n.username,required:!0}),Object(h.jsx)(E.a.Control.Feedback,{type:"invalid",children:"Username is required!"})]}),Object(h.jsxs)(E.a.Group,{children:[Object(h.jsx)(E.a.Label,{htmlFor:"password",children:"Password"}),Object(h.jsx)(E.a.Control,{type:"password",placeholder:"Your password",name:"password",onChange:O,value:n.password,required:!0}),Object(h.jsx)(E.a.Control.Feedback,{type:"invalid",children:"Password is required!"})]}),Object(h.jsx)(T.a,{disabled:!(n.username&&n.password),type:"submit",variant:"success",children:"Submit"})]})]})};var P=function(){var e=Object(l.m)();return Object(h.jsxs)("div",{className:"",children:[Object(h.jsx)(D,{}),Object(h.jsx)(H,{}),Object(h.jsx)("div",{className:"home-buttons",children:Object(h.jsx)("button",{className:"btn",onClick:function(){e("/")},children:"Home"})})]})},U=n(24);var $=function(e){var t=Object(l.m)(),n=Object(U.c)((function(e){return e.options.question_category})),c=Object(U.b)(),a=function(e){c({type:"CHANGE_LOADING",loading:e})},r=function(){var e=Object(C.a)(Object(y.a)().mark((function e(){var r;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://opentdb.com/api.php?amount=10",n.length&&(r=r.concat("&category=".concat(n))),a(!0),e.next=5,fetch(r).then((function(e){return e.json()})).then((function(e){var t;t=e.results,c({type:"SET_QUESTIONS",questions:t}),a(!1)}));case 5:c({type:"SET_INDEX",index:0}),c({type:"SET_SCORE",score:0}),t("/quiz");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)("button",{onClick:r,className:"btn",children:e.text})};var z=function(){var e=Object(l.m)(),t=Object(c.useState)(null),n=Object(p.a)(t,2),a=n[0],r=n[1],s=Object(U.c)((function(e){return e.options.loading})),o=Object(U.c)((function(e){return e.options.question_category})),i=Object(U.b)();if(Object(c.useEffect)((function(){var e=function(e){i({type:"CHANGE_LOADING",loading:e})};e(!0),fetch("https://opentdb.com/api_category.php").then((function(e){return e.json()})).then((function(t){e(!1),r(t.trivia_categories)}))}),[r,i]),!s)return Object(h.jsxs)("div",{className:"d-flex flex-column",children:[Object(h.jsxs)("div",{className:"text-center",children:[Object(h.jsx)("h2",{children:"Select Category:"}),Object(h.jsxs)("select",{value:o,onChange:function(e){i({type:"CHANGE_CATEGORY",value:e.target.value})},className:"w-75",children:[Object(h.jsx)("option",{children:"All"}),a&&a.map((function(e){return Object(h.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),Object(h.jsxs)("div",{className:"select-buttons",children:[Object(h.jsx)($,{text:"Start!"}),Object(h.jsx)("button",{onClick:function(){e("/")},className:"btn",children:"Home"})]})]})};var M=function(){var e=Object(l.m)();return Object(h.jsxs)("main",{className:"page-main d-flex justify-content-center align-items-center",children:[Object(h.jsx)("div",{className:"text-center",children:"Profile"}),Object(h.jsx)("div",{className:"home-buttons",children:Object(h.jsx)("button",{className:"btn",onClick:function(){e("/")},children:"Home"})})]})};var R=function(){return Object(h.jsx)("main",{className:"page-main d-flex justify-content-center align-items-center",children:Object(h.jsx)("div",{className:"text-center",children:"Not Found"})})},Y=(n(101),n(20)),Q=function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value};var V=function(){var e=Object(l.m)(),t=Object(c.useState)([]),n=Object(p.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(!1),i=Object(p.a)(s,2),j=i[0],u=i[1],b=Object(c.useState)(null),d=Object(p.a)(b,2),O=d[0],m=d[1],x=Object(c.useState)([]),f=Object(p.a)(x,2),v=f[0],g=f[1],w=Object(U.c)((function(e){return e.score})),N=Object(U.c)((function(e){return e.questions}));Object(c.useEffect)((function(){var e=N.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{question:Q(e.question),correct_answer:Q(e.correct_answer),incorrect_answers:e.incorrect_answers.map((function(e){return Q(e)}))})}));r(e)}),[N]);var S=Object(U.c)((function(e){return e.index})),k=Object(U.b)(),y=a[S],C=y&&y.correct_answer;Object(c.useEffect)((function(){if(S>=10&&e("/final"),y){var t,n=Object(Y.a)(y.incorrect_answers);n.splice((t=y.incorrect_answers.length,Math.floor(Math.random()*Math.floor(t))),0,y.correct_answer),g(n)}}),[y]);var _=function(e){u(!0),m(e.target.textContent),e.target.textContent===C&&k({type:"SET_SCORE",score:w+1}),S+1<=a.length&&setTimeout((function(){u(!1),m(null),k({type:"SET_INDEX",index:S+1})}),2500)},E=function(e){return j?e===C?"correct disabled":e===O?"selected disabled":"disabled":""};return y?Object(h.jsxs)("div",{children:[Object(h.jsxs)("p",{children:["Question ",S+1]}),Object(h.jsx)("h3",{children:y.question}),Object(h.jsx)("ul",{children:v.map((function(e,t){return Object(h.jsx)("li",{onClick:_,className:E(e),children:e},t)}))}),Object(h.jsxs)("div",{children:["Score: ",w," / ",a.length]})]}):Object(h.jsx)("div",{children:"Loading"})};var X=function(){var e=Object(l.m)(),t=Object(U.c)((function(e){return e.score}));return Object(h.jsxs)("div",{className:"d-flex flex-column",children:[Object(h.jsxs)("h3",{children:["Final Score: ",t]}),Object(h.jsxs)("div",{className:"select-buttons",children:[Object(h.jsx)("button",{onClick:function(){e("/")},className:"btn",children:"Home"}),Object(h.jsx)("button",{onClick:function(){e("/profile")},className:"btn",children:"Profile"})]})]})},B=n(81);var J=function(e){var t=e.children;return w.loggedIn()?t:Object(h.jsx)(l.a,{to:"/login"})},W=Object(j.a)({uri:"/graphql"}),K=Object(B.a)((function(e,t){var n=t.headers,c=localStorage.getItem("id_token");return{headers:Object(o.a)(Object(o.a)({},n),{},{authorization:c?"Bearer ".concat(c):""})}})),Z=new u.a({link:K.concat(W),cache:new b.a});var ee=function(){return Object(h.jsxs)(d.a,{client:Z,children:[Object(h.jsx)("div",{}),Object(h.jsx)(m,{}),Object(h.jsx)(i.a,{children:Object(h.jsxs)(l.d,{children:[Object(h.jsx)(l.b,{path:"/",element:Object(h.jsx)(k,{})}),Object(h.jsx)(l.b,{path:"/login",element:Object(h.jsx)(P,{})}),Object(h.jsx)(l.b,{path:"/select",element:Object(h.jsx)(J,{children:Object(h.jsx)(z,{})})}),Object(h.jsx)(l.b,{path:"/quiz",element:Object(h.jsx)(V,{})}),Object(h.jsx)(l.b,{path:"/final",element:Object(h.jsx)(X,{})}),Object(h.jsx)(l.b,{path:"/profile",element:Object(h.jsx)(J,{children:Object(h.jsx)(M,{})})}),Object(h.jsx)(l.b,{path:"*",element:Object(h.jsx)(R,{})})]})}),Object(h.jsx)(x,{})]})},te={options:{loading:!1,question_category:"",index:0,score:0}},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_LOADING":return Object(o.a)(Object(o.a)({},e),{},{options:Object(o.a)(Object(o.a)({},e.options),{},{loading:t.value})});case"CHANGE_CATEGORY":return Object(o.a)(Object(o.a)({},e),{},{options:Object(o.a)(Object(o.a)({},e.options),{},{question_category:t.value})});case"SET_QUESTIONS":return Object(o.a)(Object(o.a)({},e),{},{questions:t.questions});case"SET_INDEX":return console.log("action.index",t.index),Object(o.a)(Object(o.a)({},e),{},{index:t.index});case"SET_SCORE":return Object(o.a)(Object(o.a)({},e),{},{score:t.score});default:return e}},ce=n(83),ae=Object(ce.a)(ne);s.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(U.a,{store:ae,children:Object(h.jsx)(ee,{})})}),document.getElementById("root"))},93:function(e,t,n){}},[[102,1,2]]]);
//# sourceMappingURL=main.0763d6a8.chunk.js.map